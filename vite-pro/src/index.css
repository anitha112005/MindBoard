/* THEME VARIABLES (make dark override reliably) */
:root,
html.theme-light {
  --base: #f6f7fb;             /* page background */
  --card: #ffffff;             /* panels/cards */
  --surface: #f2f3f7;          /* subtle surfaces */
  --text: #0e121b;             /* main text */
  --muted: #5a6475;            /* secondary text */
  --border: #e2e6ef;           /* borders */
  --accent: #6366f1;
  --shadow-1: 0 2px 10px rgba(16, 24, 40, .06);
  --shadow-2: 0 10px 30px rgba(16, 24, 40, .08);
}

html.theme-dark {
  --base: #0b0f16;             /* deep dark background */
  --card: #101826;
  --surface: #0f1724;
  --text: #e6e9ef;
  --muted: #a3adbf;
  --border: #1e2a3b;
  --accent: #7aa2ff;
  --shadow-1: 0 2px 10px rgba(0, 0, 0, .35);
  --shadow-2: 0 14px 40px rgba(0, 0, 0, .45);
}

* { box-sizing: border-box; }
html, body, #root { height: 100%; }

body {
  margin: 0;
  background: var(--base);     /* The page background changes with theme */
  color: var(--text);
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
}

/* Ensure main areas adopt themed background too */
.app-layout, .app-content, .landing {
  background: var(--base);
}

/* Buttons */
.btn-outline { background: transparent; border: 1px solid var(--border); color: var(--text); }

/* Optional: adjust landing orbs for dark (so they pop on dark bg) */
.theme-dark .orb-a{ background: radial-gradient(circle at 30% 30%, #4d66ff, transparent 60%), #28307a; }
.theme-dark .orb-b{ background: radial-gradient(circle at 70% 40%, #ffb24a, transparent 60%), #7a5b28; }
.theme-dark .orb-c{ background: radial-gradient(circle at 50% 50%, #3dd8b5, transparent 60%), #1d6c5a; }

/* Controls */
a{color:inherit;text-decoration:none}
button{background:var(--accent); color:#fff; border:0; padding:.55rem .9rem; border-radius:.55rem; cursor:pointer}
button.ghost, .btn-outline{background:var(--surface); color:var(--text); border:1px solid var(--border)}
.container{max-width:1120px;margin:0 auto;padding:1.5rem}
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;box-shadow:var(--shadow-1)}
.card.soft{border-radius:16px;box-shadow:var(--shadow-2)}
.row{display:flex;gap:1rem;align-items:center}
.grid{display:grid;gap:1rem}

/* Inputs (light/dark aware) */
input[type="text"],input[type="email"],input[type="password"],input[type="search"],textarea{
  width:100%; border:1px solid var(--border); background:var(--input); color:var(--text);
  border-radius:10px; padding:.65rem .8rem; outline:none; caret-color: var(--accent);
}
input:focus,textarea:focus{border-color:var(--accent); box-shadow:0 0 0 3px color-mix(in oklab, var(--accent) 20%, transparent)}

/* Fixed top-right controls (logo + theme toggle) */
.top-right{position:fixed; top:10px; right:12px; z-index:10000; display:flex; gap:.6rem; align-items:center}
.icon-btn{width:38px;height:38px;display:grid;place-items:center;border-radius:999px;background:var(--surface);border:1px solid var(--border);box-shadow:var(--shadow-1);cursor:pointer;color:var(--text)}
.brand-dot{width:38px;height:38px;border-radius:999px;display:grid;place-items:center;background:linear-gradient(180deg,#eaf0ff,#e1eaff);border:1px solid var(--border);color:#1b2a5a;font-weight:700}
.theme-dark .brand-dot{background:linear-gradient(180deg,#151d35,#111a32);color:#e6e9f5}

/* Mode switch + fallbacks */
.mode-toggle{display:flex;align-items:center;gap:.5rem;color:var(--muted);font-weight:600}
.mode-label{user-select:none}
.switch{position:relative;width:46px;height:26px;border-radius:999px;background:#eef2f9;border:1px solid var(--border);cursor:pointer}
.theme-dark .switch{background:#222a44;border-color:#1f2a44}
.switch[data-checked="true"]{background:#dfe7ff}
.theme-dark .switch[data-checked="true"]{background:#2a3558}
.thumb{position:absolute;inset:2px auto 2px 2px;width:22px;height:22px;border-radius:999px;background:#fff;color:#1f2437;display:grid;place-items:center;font-size:12px;box-shadow:0 2px 6px rgba(0,0,0,.15);transition:transform .18s ease}
.switch[data-checked="true"] .thumb{transform:translateX(20px)}
.theme-dark .thumb{background:#0f172a;color:#ffd54a}

/* Sidebar + layout (existing rules) */
.layout{display:grid;grid-template-columns:260px 1fr;min-height:100vh}
.sidebar{width:260px;background:var(--card);border-right:1px solid var(--border);padding:.6rem .6rem 1rem;height:100vh;position:sticky;top:0;overflow:auto}
.sidebar .top{display:flex;align-items:center;justify-content:space-between;padding:.4rem .4rem .2rem}
.sidebar .ws{display:flex;align-items:center;gap:.55rem;font-weight:600}
.sidebar .search{display:flex;align-items:center;gap:.4rem;background:color-mix(in oklab, var(--surface) 80%, white 20%);border:1px solid var(--border);border-radius:8px;padding:.35rem .55rem;margin:.4rem}
.sidebar input[type="search"]{border:0;background:transparent;outline:none;width:100%}
.sidebar .section-label{font-size:12px;color:var(--muted);margin:.6rem .4rem .3rem}
.sidebar .linkish{padding:.42rem .5rem;border-radius:6px;cursor:pointer;color:var(--text)}
.sidebar .linkish:hover{background:color-mix(in oklab, var(--surface) 80%, white 20%)}

/* Tree */
.tree{display:grid;gap:.2rem;margin:.2rem 0}
.tree-item{display:grid;grid-template-columns:18px 1fr auto;align-items:center;gap:.3rem;padding:.32rem .4rem;border-radius:6px;cursor:pointer}
.tree-item:hover{background:color-mix(in oklab, var(--surface) 80%, white 20%)}
.tree-item.active{background:color-mix(in oklab, var(--surface) 70%, #dfe7ff 30%)}
.tree-indent{width:12px}
.tree-actions{visibility:hidden}
.tree-item:hover .tree-actions{visibility:visible}
.tree-children{margin-left:14px}

/* Editor */
.editor{max-width:820px;margin:1.4rem auto;padding:0 1.2rem 6rem;line-height:1.6}
.titlebar{margin:1rem 0 .6rem}
.titlebar h1[contenteditable="true"]{outline:none;border:none;background:transparent;font-size:2.2rem;line-height:1.2;margin:0;color:var(--text)}
.titlebar h1.placeholder:empty::before{content:'Untitled';color:var(--muted)}
.toolbar{position:sticky;top:0;background:linear-gradient(var(--card) 70%, transparent);padding:.6rem 0;display:flex;gap:.5rem;z-index:5}
.slashmenu{position:absolute;background:var(--card);border:1px solid var(--border);border-radius:.6rem;padding:.4rem;width:280px;box-shadow:var(--shadow-1)}
.slashmenu button{width:100%;text-align:left;background:transparent;border:0;color:var(--text);padding:.5rem .6rem;border-radius:.4rem}
.slashmenu button:hover{background:color-mix(in oklab, var(--surface) 80%, white 20%)}
.editor p,.editor li{color:var(--text)}
.editor .todo{display:flex;gap:.6rem;align-items:baseline}
.table{width:100%;border-collapse:collapse}
.table th,.table td{border-bottom:1px solid var(--border);padding:.6rem .4rem;text-align:left}
.kanban{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem}
.column{background:color-mix(in oklab, var(--surface) 85%, white 15%);border:1px solid var(--border);border-radius:.8rem;padding:.6rem}
.note{background:color-mix(in oklab, var(--surface) 90%, white 10%);border:1px dashed var(--border);padding:.8rem 1rem;border-radius:.6rem;color:var(--muted)}

/* ===== Landing (unique look) ===== */
.landing { overflow-x: hidden; }
.landing-nav{display:flex;align-items:center;justify-content:space-between;padding:1.1rem 1.25rem}
.landing .brand{display:flex;align-items:center;gap:.6rem}
.beta-pill{font-size:.72rem;background:var(--surface);border:1px solid var(--border);padding:.2rem .45rem;border-radius:999px;color:var(--muted)}
.nav-links{display:flex;gap:1rem;color:var(--muted)}
.nav-links a{padding:.35rem .5rem;border-radius:.55rem}
.nav-links a:hover{background:var(--surface)}

.hero{position:relative;padding:2.5rem 1.25rem 3rem}
.hero-grid{display:grid;grid-template-columns:1.05fr 1.25fr;gap:2rem;align-items:center}
@media (max-width: 960px){ .hero-grid{grid-template-columns:1fr} }

.hero h1{font-size:clamp(2rem,5vw,3.2rem);line-height:1.1;margin:0 0 .6rem}
.hero p{color:var(--muted);max-width:52ch}
.hero-badges{display:flex;flex-wrap:wrap;gap:.5rem;margin-top:10px}
.hero-badges span{background:var(--surface);border:1px solid var(--border);padding:.35rem .6rem;border-radius:999px;font-size:.86rem;color:var(--text)}

.orb{position:absolute;filter:blur(22px);border-radius:999px;opacity:.55;pointer-events:none;animation:float 12s ease-in-out infinite}
.orb-a{width:360px;height:360px;left:-80px;top:-40px;background:radial-gradient( circle at 30% 30%, #9db5ff, transparent 60%), #b9c7ff}
.orb-b{width:320px;height:320px;right:-80px;top:-60px;background:radial-gradient( circle at 70% 40%, #ffd7a2, transparent 60%), #ffe3b8;animation-delay:3s}
.orb-c{width:280px;height:280px;left:40%;bottom:-120px;background:radial-gradient( circle at 50% 50%, #a0ffe2, transparent 60%), #c2ffe8;animation-delay:6s}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-18px)}}

.hero-mock{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow-2);display:grid;grid-template-columns:220px 1fr;overflow:hidden}
.mock-sidebar{background:color-mix(in oklab, var(--surface) 80%, transparent);border-right:1px solid var(--border);padding:.6rem}
.mock-item{padding:.5rem .6rem;border-radius:.5rem;color:var(--muted)}
.mock-item.active{background:var(--surface);color:var(--text);border:1px solid var(--border)}
.mock-body{position:relative;padding:1rem}
.mock-toolbar{display:flex;gap:.5rem;align-items:center;margin-bottom:.6rem}
.pill{padding:.25rem .5rem;border:1px solid var(--border);border-radius:.5rem;background:var(--surface);font-size:.86rem}
.shine{position:absolute;right:18px;top:10px;width:120px;height:26px;background:linear-gradient(100deg,transparent,rgba(255,255,255,.6),transparent);filter:blur(6px);opacity:.35;animation:shine 3.5s linear infinite}
@keyframes shine{0%{transform:translateX(-160px)}100%{transform:translateX(120px)}}
.mock-title{margin:.3rem 0}
.mock-sub{color:var(--muted);margin:0 0 .75rem}
.mock-cards{display:grid;grid-template-columns:repeat(4, minmax(90px,1fr));gap:.6rem}
.mock-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:.9rem;text-align:center;box-shadow:var(--shadow-1)}
.float1{animation:floatY 6s ease-in-out infinite}
.float2{animation:floatY 7s ease-in-out infinite .3s}
.float3{animation:floatY 6.7s ease-in-out infinite .6s}
.float4{animation:floatY 6.2s ease-in-out infinite .9s}
@keyframes floatY{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
.mock-gallery{display:grid;grid-template-columns:repeat(3,1fr);gap:.5rem;margin-top:.9rem}
.mock-gallery img{height:120px;object-fit:cover;border-radius:10px;filter:saturate(1.05);}

.features{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;padding:1rem 1.25rem}
@media (max-width: 960px){ .features{grid-template-columns:1fr 1fr} }
@media (max-width: 640px){ .features{grid-template-columns:1fr} }
.feature{padding:1rem}
.feature-icon{font-size:1.4rem;background:var(--surface);border:1px solid var(--border);width:36px;height:36px;border-radius:10px;display:grid;place-items:center;margin-bottom:.4rem}

.showcase{display:grid;grid-template-columns:2fr 1.25fr;grid-template-areas:'a b' 'a c';gap:1rem;padding:1rem 1.25rem}
.showcase .panel{overflow:hidden}
.panel img{width:100%;height:220px;object-fit:cover;border-radius:10px;margin-top:.5rem}
.panel.a{grid-area:a}
.panel.b{grid-area:b}
.panel.c{grid-area:c}

.cta{display:flex;align-items:center;justify-content:space-between;margin:2rem 1.25rem;padding:1.2rem 1.4rem;gap:1rem}
.cta .btn-outline{padding:.6rem .9rem}
.footer{display:flex;align-items:center;justify-content:space-between;padding:1.5rem 1.25rem 3rem;color:var(--muted)}

/* Reveal animation */
[data-reveal]{opacity:0;transform:translateY(14px);transition:opacity .6s ease, transform .6s ease}
.is-visible{opacity:1;transform:none}

/* Make landing visually distinct in dark */
.theme-dark .orb-a{background:radial-gradient(circle at 30% 30%, #4d66ff, transparent 60%), #28307a}
.theme-dark .orb-b{background:radial-gradient(circle at 70% 40%, #ffb24a, transparent 60%), #7a5b28}
.theme-dark .orb-c{background:radial-gradient(circle at 50% 50%, #3dd8b5, transparent 60%), #1d6c5a}

/* ===== App layout (Notion-like) ===== */
.app-layout{display:grid;grid-template-columns:280px 1fr;height:100%}
@media (max-width: 860px){ .app-layout{grid-template-columns:1fr} }

.app-content{height:100%;overflow:auto;background:var(--base)}

/* App layout + sidebar polish */
.app-layout{display:grid;grid-template-columns:280px 1fr;height:100%}
@media (max-width: 860px){ .app-layout{grid-template-columns:1fr} }
.app-content{height:100%;overflow:auto;background:var(--base)}

.sidebar{position:sticky;top:0;height:100vh;display:flex;flex-direction:column;background:var(--surface);border-right:1px solid var(--border);padding:.6rem}
.brand{display:flex;align-items:center;gap:.5rem;border:0;background:transparent;color:inherit;cursor:pointer}
.avatar{width:28px;height:28px;border-radius:999px;background:var(--accent);color:#fff;display:grid;place-items:center;font-weight:700}
.sb-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:.5rem}
.sb-search{padding:.35rem 0}
.sb-search input{width:100%;padding:.45rem .6rem;border:1px solid var(--border);border-radius:.5rem;background:var(--base);color:var(--text)}
.sb-nav{display:flex;flex-direction:column;gap:.25rem;margin:.35rem 0}
.nav-item{display:flex;align-items:center;gap:.5rem;text-decoration:none;color:inherit;padding:.46rem .55rem;border-radius:.55rem}
.nav-item:hover{background:var(--base)}
.nav-item.active{background:var(--card);border:1px solid var(--border)}
.nav-item.smallrow{padding:.38rem .5rem;font-size:.95rem}
.badge-new{margin-left:auto;background:var(--surface);border:1px solid var(--border);padding:.05rem .4rem;border-radius:999px;font-size:.72rem;color:var(--muted)}
.hr{height:1px;background:var(--border);margin:.35rem 0}
.sb-section{flex:1;overflow:auto}
.sb-section-head{display:flex;align-items:center;justify-content:space-between;margin:.5rem 0 .35rem;color:var(--muted)}
.page-tree{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:.1rem}
.page-item .linklike{width:100%;text-align:left;padding:.4rem .5rem;border-radius:.45rem}
.page-item .linklike:hover{background:var(--base)}
.page-item.active .linklike{background:var(--card);border:1px solid var(--border)}
.rename-input{width:100%;padding:.35rem .45rem;border:1px solid var(--border);border-radius:.45rem;background:var(--base);color:var(--text)}
.sb-footer{padding-top:.5rem;border-top:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;color:var(--muted)}

/* Home page layout */
.home .home-shell{max-width:1120px;margin:0 auto;padding:1rem}
.home-top{display:flex;align-items:flex-end;justify-content:space-between;margin:.5rem 0 1rem}
.home-quick{display:grid;grid-template-columns:repeat(3,1fr);gap:.8rem;margin-bottom:1rem}
@media (max-width: 860px){ .home-quick{grid-template-columns:1fr} }

.home-card{border:1px solid var(--border);border-radius:12px;background:var(--surface);padding:.9rem;text-align:left;transition:transform .15s ease, box-shadow .15s ease}
.home-card:hover{transform:translateY(-2px);box-shadow:var(--shadow-2)}
.home-card-icon{font-size:1.3rem;margin-bottom:.25rem}
.home-card-title{font-weight:600}
.home-card-sub{color:var(--muted);font-size:.92rem}

.home-recent{padding:1rem}
.recent-grid{list-style:none;margin:0;padding:0;display:grid;grid-template-columns:repeat(3,1fr);gap:.8rem}
@media (max-width: 1100px){ .recent-grid{grid-template-columns:repeat(2,1fr)} }
@media (max-width: 640px){ .recent-grid{grid-template-columns:1fr} }
.recent-card{border:1px solid var(--border);border-radius:12px;background:var(--card);padding:.75rem;display:flex;flex-direction:column;gap:.4rem}
.r-head{display:flex;align-items:center;justify-content:space-between;color:var(--muted)}
.r-icon{font-size:1.1rem}
.r-title{background:transparent;border:0;color:inherit;text-align:left;font-weight:600;cursor:pointer}
.r-actions{display:flex;gap:.4rem;margin-top:.1rem}
.small{font-size:.82rem;padding:.35rem .6rem}
.btn-outline{background:transparent;border:1px solid var(--border);color:var(--text)}
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;box-shadow:var(--shadow-1)}
.sec-head{display:flex;align-items:center;justify-content:space-between;margin:0 0 .6rem}

/* Aspect-ratio helpers */
.ratio-16x9{ position:relative; }
.ratio-16x9::before{ content:''; display:block; padding-top:56.25%; }
.ratio-16x9 > *{ position:absolute; inset:0; }

/* ImageX skeleton shimmer */
.imgx{ background: var(--surface); border-radius: 10px; }
.imgx .imgx-skel{
  position:absolute; inset:0; pointer-events:none; opacity:.55;
  background: linear-gradient(100deg, transparent, rgba(255,255,255,.28), transparent);
  transform: translateX(-100%);
  animation: imgx-shine 1.4s linear infinite;
}
@keyframes imgx-shine { to { transform: translateX(100%); } }

/* Template media polish */
.tpl-media{ border:1px solid var(--border); border-radius:10px; overflow:hidden }
.tpl-emoji{ position:absolute; left:8px; top:8px; z-index:2; background:rgba(255,255,255,.75);
  backdrop-filter:blur(6px); border:1px solid var(--border); border-radius:8px; padding:.15rem .35rem }
.theme-dark .tpl-emoji{ background:rgba(0,0,0,.35) }

/* Landing */
.landing{min-height:100%; background:var(--base)}
.landing-top{max-width:1180px;margin:0 auto;padding:1rem 1.2rem;display:flex;justify-content:space-between;align-items:center}
.logo{font-weight:700}
.hero-grid{position:relative;max-width:1180px;margin:0 auto;padding:1.2rem;display:grid;grid-template-columns:1.05fr .95fr;gap:1.2rem}
@media (max-width: 980px){ .hero-grid{grid-template-columns:1fr} }

.hero-left h1{font-size:clamp(28px,4.5vw,52px);line-height:1.04;margin:.2rem 0 .6rem}
.hero-left .lead{color:var(--muted);max-width:56ch}
.hero-left .chips{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:.8rem}
.hero-left .chips span{background:var(--surface);border:1px solid var(--border);padding:.3rem .6rem;border-radius:999px;font-size:.86rem}

.hero-right{display:grid;gap:.8rem;align-content:start}
.card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow-2)}
.assistant{padding:.9rem}
.assistant-head{display:flex;align-items:center;gap:.6rem;margin-bottom:.5rem}
.assistant .agent{width:32px;height:32px;border-radius:10px;display:grid;place-items:center;background:var(--surface);border:1px solid var(--border)}
.assistant .title{font-weight:700}
.assistant-box{position:relative;border:1px solid var(--border);border-radius:14px;background:var(--surface);padding:.7rem .9rem .8rem;display:flex;align-items:center;gap:.6rem}
.assistant-box .pill{font-size:.82rem;border:1px dashed var(--border);padding:.15rem .45rem;border-radius:999px;background:transparent}
.assistant-box .type{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.caret{display:inline-block;width:10px;height:1.05em;vertical-align:-.15em;border-left:2px solid var(--text);margin-left:2px;animation:blink .9s steps(1,end) infinite}
@keyframes blink{50%{opacity:0}}
.assistant-box .send{border:1px solid var(--border);background:var(--card);border-radius:10px;padding:.35rem .5rem}
.assistant-chips{display:flex;gap:.4rem;margin-top:.6rem}
.assistant-chips span{background:var(--surface);border:1px solid var(--border);padding:.25rem .5rem;border-radius:.5rem;font-size:.82rem}

.hero-images{display:grid;grid-template-columns:1.2fr .8fr;gap:.6rem}
.hero-images > .kb:nth-child(3){grid-column:1 / span 2;height:180px}
@media (max-width: 980px){ .hero-images{grid-template-columns:1fr} .hero-images > .kb:nth-child(3){grid-column:auto;height:200px} }
.kb{border:1px solid var(--border);border-radius:12px;overflow:hidden;position:relative;height:160px;background:var(--surface)}
.kb .imgx img{animation: kb-zoom var(--kb-dur, 18s) ease-in-out infinite; transform-origin:50% 50%}
.kb.kb-left  .imgx img{transform-origin:10% 50%}
.kb.kb-right .imgx img{transform-origin:90% 50%}
.kb.kb-up    .imgx img{transform-origin:50% 10%}
.kb.kb-down  .imgx img{transform-origin:50% 90%}
@keyframes kb-zoom{ 0%{transform:scale(1)} 50%{transform:scale(1.1)} 100%{transform:scale(1)} }

.orb{position:absolute;filter:blur(24px);opacity:.45;border-radius:999px;pointer-events:none}
.orb-a{width:260px;height:260px;left:-60px;top:-60px;background:radial-gradient(circle at 30% 30%, #9db5ff, transparent 60%), #b9c7ff}
.orb-b{width:220px;height:220px;right:-40px;bottom:-40px;background:radial-gradient(circle at 70% 40%, #ffd7a2, transparent 60%), #ffe3b8}
.theme-dark .orb-a{background:radial-gradient(circle at 30% 30%, #4d66ff, transparent 60%), #28307a}
.theme-dark .orb-b{background:radial-gradient(circle at 70% 40%, #ffb24a, transparent 60%), #7a5b28}